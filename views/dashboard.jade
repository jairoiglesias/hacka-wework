extends layout_login

block content

    script(type="text/javascript").
  
        $(document).ready(function(){

            //- function updateChart(ano, mes){

            //-     setTimeout(function(){

            //-         var result
            //-         //- var categoriesFiat = ''
            //-         //- var categoriesConcorrencia = ''

            //-         // Recupera os dados da FIAT
            //-         var promiseFiat = $.ajax({
            //-             type:'get',
            //-             url: 'top5_comparativo_mes_fiat/'+ano+'/'+mes,
            //-         })

            //-         promiseFiat.then(function(dadosFiat){

            //-             result = dadosFiat

            //-             var categoriesTemp = []

            //-             dadosFiat.forEach(function(value, index){
                                
            //-                 var item = value.estado + ' | ' + value.MUNICIPIO

            //-                 if(categoriesTemp.indexOf(item) == -1){
            //-                     categoriesTemp.push(item)
            //-                 }

            //-             })

            //-             var promiseConcorrencia = $.ajax({
            //-                 type:'post',
            //-                 url: 'top5_comparativo_mes_concorrencia_v2',
            //-                 data:{
            //-                     ano:ano,
            //-                     mes:mes,
            //-                     categories:JSON.stringify(categoriesTemp)
            //-                 }
            //-             })

            //-             promiseConcorrencia.then(function(dadosConcorrencia){

            //-                 //- result = result.concat(dadosConcorrencia)

            //-                 //- console.log(dadosConcorrencia)

            //-                 var categories = []
            //-                 var seriesFiat = []
            //-                 var series = []

            //-                 // Efetua o mapeamento de items da FIAT
            //-                 result.forEach(function(value, index){
                                
            //-                     var item = value.estado + ' | ' + value.MUNICIPIO

            //-                     if(categories.indexOf(item) == -1){
            //-                         categories.push(item)
            //-                     }

            //-                     if(value.MARCA == 'FIAT'){
            //-                         seriesFiat.push(value.TOTAL)
            //-                     }

            //-                     //- if(value.MARCA != 'FIAT'){
            //-                     //-     seriesConcorrencia.push(value.TOTAL)
            //-                     //- }

            //-                 })

            //-                 series.push({
            //-                     name: 'FIAT',
            //-                     data: seriesFiat
            //-                 })

            //-                 //- console.log(series)

            //-                 var newCategorias = []

            //-                 categories.forEach(function(categoriaProc, index){

            //-                     var _categoriaProc = categoriaProc
            //-                     var _estado = _categoriaProc.split('|')[0].trim()
            //-                     var _municipio = _categoriaProc.split('|')[1].trim()

            //-                     console.log(_municipio)

            //-                     // Efetua o mapeamento de dados do TOP 5 concorrentes
            //-                     dadosConcorrencia.forEach(function(valueConc, index){

            //-                         //- console.log(_municipio)
            //-                         //- console.log(valueConc)
                                    

            //-                         var MUNICIPIO = valueConc.categoria[0].MUNICIPIO
            //-                         var MARCA = valueConc.categoria[0].MARCA
                                    
            //-                         if(MUNICIPIO == _municipio){

            //-                             var serieConc = []
                                        
            //-                             valueConc.categoria.forEach(function(valueCategoria, indexCategoria){
            //-                                 serieConc.push(valueCategoria.TOTAL)
            //-                             })

            //-                             series.push({
            //-                                 name: MARCA,
            //-                                 data: serieConc
            //-                             })

                                        
            //-                         }
            //-                     })

            //-                 })


            //-                 console.log(series)

            //-                 var myChart = new Highcharts.chart('dashboard01', {
            //-                     chart: {
            //-                         type: 'column'
            //-                     },
            //-                     title: {
            //-                         text: 'Top5 Cidades'
            //-                     },
            //-                     subtitle: {
            //-                         text: 'Comparativo com a concorrência'
            //-                     },
            //-                     xAxis: {
            //-                         categories: categories,
            //-                         crosshair: true
            //-                     },
            //-                     yAxis: {
            //-                         min: 0,
            //-                         title: {
            //-                             text: ''
            //-                         }
            //-                     },
            //-                     tooltip: {
            //-                         headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
            //-                         pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
            //-                             '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
            //-                         footerFormat: '</table>',
            //-                         shared: true,
            //-                         useHTML: true
            //-                     },
            //-                     plotOptions: {
            //-                         column: {
            //-                             dataLabels: {
            //-                             enabled: true
            //-                             },
            //-                             pointPadding: 0.2,
            //-                             borderWidth: 0
            //-                         },
            //-                         series:{
            //-                             cursor:'pointer',
            //-                             point:{
            //-                                 events:{
            //-                                     click: function(){
            //-                                         alert('hue')
            //-                                     }
            //-                                 }
            //-                             }
            //-                         }
            //-                     },
            //-                     series: series
            //-                 });
            //-             })
                        


            //-         })
                    

            //-     }, 0001)
            
                
            //- }

            function updateChartV2(){

                Highcharts.chart('dashboard01', {
                    title: {
                        text: 'Top 5 bairros mais alugados'
                    },
                    xAxis: {
                        categories: ['Apples', 'Oranges', 'Pears', 'Bananas', 'Plums']
                    },
                    labels: {
                        items: [{
                            html: 'Total fruit consumption',
                            style: {
                                left: '50px',
                                top: '18px',
                                color: (Highcharts.theme && Highcharts.theme.textColor) || 'black'
                            }
                        }]
                    },
                    series: [{
                        type: 'column',
                        name: 'Jane',
                        data: [3, 2, 1, 3, 4]
                    }, {
                        type: 'column',
                        name: 'John',
                        data: [2, 3, 5, 7, 6]
                    }, {
                        type: 'column',
                        name: 'Joe',
                        data: [4, 3, 3, 9, 0]
                    }, {
                        type: 'spline',
                        name: 'Average',
                        data: [3, 2.67, 3, 6.33, 3.33],
                        marker: {
                            lineWidth: 2,
                            lineColor: Highcharts.getOptions().colors[3],
                            fillColor: 'white'
                        }
                    }, {
                        type: 'pie',
                        name: 'Total consumption',
                        data: [{
                            name: 'Jane',
                            y: 13,
                            color: Highcharts.getOptions().colors[0] // Jane's color
                        }, {
                            name: 'John',
                            y: 23,
                            color: Highcharts.getOptions().colors[1] // John's color
                        }, {
                            name: 'Joe',
                            y: 19,
                            color: Highcharts.getOptions().colors[2] // Joe's color
                        }],
                        center: [100, 80],
                        size: 100,
                        showInLegend: false,
                        dataLabels: {
                            enabled: false
                        }
                    }]
                });


            }

            //- var myChart = new Highcharts.chart('dashboard01', {
            //-     chart: {
            //-         type: 'column'
            //-     },
            //-     title: {
            //-         text: 'Top5 Cidades'
            //-     },
            //-     subtitle: {
            //-         text: 'Comparativo com a concorrência'
            //-     },
            //-     xAxis: {
            //-         categories: '',
            //-         crosshair: true
            //-     },
            //-     yAxis: {
            //-         min: 0,
            //-         title: {
            //-             text: ''
            //-         }
            //-     },
            //-     tooltip: {
            //-         headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
            //-         pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
            //-             '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
            //-         footerFormat: '</table>',
            //-         shared: true,
            //-         useHTML: true
            //-     },
            //-     plotOptions: {
            //-         column: {
            //-             dataLabels: {
            //-             enabled: true
            //-             },
            //-             pointPadding: 0.2,
            //-             borderWidth: 0
            //-         }
            //-     },
            //-     series: ''
            //- });

            //- updateChart('2015','01')


            //- $('#mes').change(function(){

            //-     var ano = $('#ano').val()
            //-     var mes = $('#mes').val()

            //-     $('#dashboard01').children().remove()
            //-     $('#dashboard01').append('Carregando ...')

            //-     updateChart(ano, mes)

            //- })

            // MAPA

            updateChartV2()
        
        })
    br
    br
    div(class='container')

    hr
    div.container
        div(id="dashboard01" style="width:90%")
        hr
        div(id="myDiv" style="width:90%")


